# AVALA Environment Configuration
# Phase 0 - Local Development

# ============================================
# CORE
# ============================================
# See PORT_REGISTRY.md in solarpunk-foundry for port assignments
NODE_ENV=development
WEB_PORT=3010
API_PORT=4000
WEB_URL=http://localhost:3010
API_URL=http://localhost:4000

# ============================================
# DATABASE
# ============================================
DATABASE_URL=postgresql://avala:avala@localhost:5432/avala

# ============================================
# CACHE & QUEUE
# ============================================
REDIS_URL=redis://localhost:6379

# ============================================
# OBJECT STORAGE (MinIO/S3)
# ============================================
S3_ENDPOINT=http://localhost:9000
S3_REGION=us-east-1
S3_BUCKET=avala-evidence
S3_ACCESS_KEY=avala
S3_SECRET_KEY=avala123
S3_USE_PATH_STYLE=true

# ============================================
# AUTH & SSO
# ============================================
JWT_SECRET=change-me-in-production-use-strong-random-string
JWT_EXPIRES_IN=1d
REFRESH_TOKEN_EXPIRES_IN=7d

# OIDC (Optional - for SSO)
OIDC_ISSUER=
OIDC_CLIENT_ID=
OIDC_CLIENT_SECRET=
OIDC_CALLBACK_URL=http://localhost:4000/v1/auth/callback

# ============================================
# EMAIL (SMTP fallback for local development)
# ============================================
SMTP_HOST=localhost
SMTP_PORT=1025
SMTP_SECURE=false
SMTP_USER=
SMTP_PASS=
EMAIL_FROM="Avala <no-reply@avala.local>"

# ============================================
# JANUA EMAIL SERVICE (centralized Resend)
# ============================================
JANUA_API_URL=https://api.janua.dev
JANUA_INTERNAL_API_KEY=your-janua-internal-api-key

# ============================================
# OPEN BADGES / VERIFIABLE CREDENTIALS
# ============================================
OB_ISSUER_DID=did:web:localhost
OB_ISSUER_KID=did:web:localhost#keys-1
OB_PRIVATE_KEY_PATH=./keys/issuer.key
OB_PUBLIC_KEY_PATH=./keys/issuer.pub

# ============================================
# LRS (xAPI/cmi5) - Phase 2
# ============================================
LRS_BASIC_USER=lrs
LRS_BASIC_PASS=lrs

# ============================================
# FEATURES (Phase Flags)
# ============================================
FEATURE_EC_MAPPING=true
FEATURE_DC3_GENERATION=false  # Phase 1
FEATURE_SIRCE_EXPORT=false    # Phase 1
FEATURE_LRS=false             # Phase 2
FEATURE_OBV3=false            # Phase 2
FEATURE_SCORM=false           # Phase 3
FEATURE_ECE_OC_TOOLKIT=false  # Phase 3

# ============================================
# SECURITY
# ============================================
ENCRYPTION_KEY=change-me-32-char-min-encryption-key-here
CORS_ORIGINS=http://localhost:3000

# ============================================
# LOGGING & MONITORING
# ============================================
LOG_LEVEL=debug
LOG_FORMAT=json

# Sentry (Optional)
SENTRY_DSN=

# ============================================
# RATE LIMITING
# ============================================
RATE_LIMIT_TTL=60
RATE_LIMIT_MAX=100

# ============================================
# LOCALIZATION
# ============================================
DEFAULT_LOCALE=es-MX
SUPPORTED_LOCALES=es-MX,en-US
TIMEZONE=America/Mexico_City

# ============================================
# BILLING (Janua Integration)
# ============================================
JANUA_API_URL=http://janua-api:8001
JANUA_API_KEY=your-janua-api-key
JANUA_WEBHOOK_SECRET=your-webhook-secret

# Payment Providers (via Janua)
# Mexico: Conekta (SPEI, cards, CFDI)
# International: Polar.sh / Stripe fallback
BILLING_COUNTRY_DEFAULT=MX

# Janua Webhook (for receiving billing events)
JANUA_WEBHOOK_SECRET=your-janua-webhook-secret
